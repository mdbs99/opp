<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Object Pascal Programming</title>
    <description>Sacadas sobre Programa√ß√£o Orientada a Objetos e Object Pascal.
</description>
    <link>http://objectpascalprogramming.com/</link>
    <atom:link href="http://objectpascalprogramming.com/feed.xml" rel="self" type="application/rss+xml" />
    
      <item>
        <title>Interfaces e o M√©todo est√°tico New</title>
        <description>&lt;p&gt;No &lt;a href=&quot;/posts/pensando-em-objetos/&quot;&gt;post anterior&lt;/a&gt; eu mostrei um c√≥digo
Orientado a Objetos onde os Objetos eram instanciados utilizando um M√©todo est√°tico chamado &lt;code&gt;New&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Este m√©todo &lt;code&gt;New&lt;/code&gt; n√£o √© padr√£o da linguagem Object Pascal. Ele tamb√©m n√£o √© um &lt;code&gt;constructor&lt;/code&gt;.
Ele √© um &lt;strong&gt;M√©todo de classe&lt;/strong&gt; que retorna a mesma Interface que a classe implementa.&lt;/p&gt;

&lt;p&gt;A utiliza√ß√£o do M√©todo &lt;code&gt;New&lt;/code&gt; √© um padr√£o que defini para todos os meus projetos.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;&lt;img src=&quot;/images/829d24cf.jpg&quot; alt=&quot;Pensando&quot; /&gt;&lt;/p&gt;
&lt;meta name=&quot;og:image&quot; content=&quot;/images/829d24cf.jpg&quot; /&gt;

&lt;h2 id=&quot;object-pascal-e-seu-garbage-collector&quot;&gt;Object Pascal e seu ‚Äú&lt;em&gt;Garbage Collector&lt;/em&gt;‚Äù&lt;/h2&gt;

&lt;p&gt;Ok. Object Pascal n√£o tem &lt;em&gt;garbage collector&lt;/em&gt; como no Java ou C# ‚Äî e isso √© √≥timo quando precisamos de performance ‚Äî
por√©m temos algo parecido quando utilizamos Interfaces.&lt;/p&gt;

&lt;p&gt;Toda vari√°vel que tem uma Interface como seu tipo, por padr√£o, ser√° desalocada da mem√≥ria assim que
sair do escopo de execu√ß√£o. Vamos chamar essas vari√°veis de &lt;strong&gt;vari√°vel-interface&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;No momento que o compilador sabe que a vari√°vel-interface n√£o ser√° mais utilizada, ele desaloca a mem√≥ria
chamando o &lt;code&gt;destructor&lt;/code&gt; da inst√¢ncia.&lt;/p&gt;

&lt;p&gt;Isso √© √≥timo para a programa√ß√£o Orientada a Objetos.&lt;/p&gt;

&lt;p&gt;Significa que, se eu fizer isso corretamente, poderei criar Objetos dentro de Objetos, encadear chamadas de Objetos,
criar novas inst√¢ncias &lt;code&gt;inline&lt;/code&gt; para utilizar em argumentos e muito mais‚Ä¶ assim como fazem no Java ou C#.&lt;/p&gt;

&lt;h2 id=&quot;o-problema&quot;&gt;O problema&lt;/h2&gt;

&lt;p&gt;Existe um grande problema em utilizar Interfaces:&lt;/p&gt;

&lt;p&gt;A falta da vari√°vel-interface.&lt;/p&gt;

&lt;p&gt;Se n√£o implementar da forma correta, voc√™ ter√° algumas viola√ß√µes de acesso (&lt;code&gt;Access Violation&lt;/code&gt;)
e/ou vazamentos de mem√≥ria (&lt;code&gt;memleaks&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Para que o &lt;em&gt;garbage colletor&lt;/em&gt; funcione corretamente voc√™ precisa ter uma vari√°vel-interface para receber a inst√¢ncia, sempre.&lt;/p&gt;

&lt;p&gt;Considere o c√≥digo abaixo:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-pascal&quot; data-lang=&quot;pascal&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TFoo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;bp&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;TTask √© uma classe que recebe uma &lt;code&gt;string&lt;/code&gt; no construtor;&lt;/li&gt;
  &lt;li&gt;TTask implementa ITask, uma Interface;&lt;/li&gt;
  &lt;li&gt;TAction √© uma classe que recebe uma &lt;strong&gt;interface&lt;/strong&gt; ITask no construtor;&lt;/li&gt;
  &lt;li&gt;TAction implementa IAction, uma Interface;&lt;/li&gt;
  &lt;li&gt;TAction tem um m√©todo Execute que retorna uma interface IResult;&lt;/li&gt;
  &lt;li&gt;IResult tem um m√©todo ToString que retorna o resultado no formato &lt;code&gt;string&lt;/code&gt;;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Quantos vazamentos de mem√≥ria teremos: 0, 1 ou 2?&lt;/p&gt;

&lt;p&gt;A resposta √© 1.&lt;/p&gt;

&lt;p&gt;Porque?&lt;/p&gt;

&lt;p&gt;O compilador far√° o seguinte (mais ou menos, em termos leigos):&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Executar TTask.Create(Name), criando a inst√¢ncia;&lt;/li&gt;
  &lt;li&gt;A inst√¢ncia criada ir√° ser passada no argumento, que √© do tipo ITask, do construtor de TAction;&lt;/li&gt;
  &lt;li&gt;TAction ir√° criar uma inst√¢ncia de IResult quando chamar Execute;&lt;/li&gt;
  &lt;li&gt;Utilizando a inst√¢ncia de IResult, o m√©todo ToString √© chamado e uma &lt;code&gt;string&lt;/code&gt; √© retornada;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Onde est√° o erro?&lt;/p&gt;

&lt;p&gt;Na chamada &lt;code&gt;TAction.Create&lt;/code&gt; porque a inst√¢ncia n√£o √© referenciada por nenhuma vari√°vel-interface!&lt;/p&gt;

&lt;p&gt;O compilador n√£o tem uma refer√™ncia, ent√£o ele n√£o sabe se deve desalocar a mem√≥ria.&lt;/p&gt;

&lt;p&gt;Na chamada &lt;code&gt;TTask.Create(Name)&lt;/code&gt; n√£o h√° problema. O argumento de &lt;code&gt;TAction&lt;/code&gt; recebe uma &lt;code&gt;ITask&lt;/code&gt;, ent√£o o compilador
sabe que dever√° desalocar essa inst√¢ncia logo que n√£o precisar mais dela.&lt;/p&gt;

&lt;p&gt;Ent√£o vamos acertar o c√≥digo:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-pascal&quot; data-lang=&quot;pascal&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TFoo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;bp&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Agora n√£o haver√° &lt;code&gt;memleaks&lt;/code&gt; porque agora o compilador tem a refer√™ncia &lt;code&gt;A&lt;/code&gt; para &lt;code&gt;TAction&lt;/code&gt;. No fim do m√©todo
&lt;code&gt;TFoo.Execute&lt;/code&gt; a inst√¢ncia em &lt;code&gt;A&lt;/code&gt; ser√° liberada automaticamente.&lt;/p&gt;

&lt;p&gt;Se n√£o me falha a mem√≥ria isso foi implementado no Delphi
a partir da vers√£o 3 (me corrijam se eu estiver errado).&lt;/p&gt;

&lt;p&gt;Tem muito material sobre isso na Internet se quiserem mais detalhes, mas acredito que voc√™ j√° sabia disso
ou ao menos j√° leu sobre isso alguma vez.&lt;/p&gt;

&lt;h2 id=&quot;o-mtodo-new&quot;&gt;O m√©todo New&lt;/h2&gt;

&lt;p&gt;Se voc√™ prestou aten√ß√£o nos c√≥digos acima, vai reparar que est√° na m√£o do programador saber quando utilizar
uma vari√°vel-interface para ‚Äúdizer‚Äù ao compilador que a inst√¢ncia dever√° ser liberada automaticamente‚Ä¶&lt;/p&gt;

&lt;p&gt;E √© claro que voc√™ vai esquecer disso quando estiver programando‚Ä¶ v√°rias vezes! Aconteceu comigo. Centenas de vezes.&lt;/p&gt;

&lt;p&gt;Nem precisa ser esquecimento, basta o c√≥digo mudar numa parte para come√ßar a ter &lt;code&gt;memleaks&lt;/code&gt;, exemplo:&lt;/p&gt;

&lt;p&gt;Se o argumento √© do tipo Interface, n√£o h√° problema em criar uma inst√¢ncia &lt;code&gt;inline&lt;/code&gt;, mas e se o c√≥digo for
alterado para receber uma classe concreta (mudou de IAction para TAction o argumento)? 
O c√≥digo pode continuar funcionando, por√©m haver√° &lt;code&gt;memleaks&lt;/code&gt; porque
o compilador n√£o ir√° mais desalocar a inst√¢ncia criada no argumento por n√£o ser mais do tipo Interface.&lt;/p&gt;

&lt;p&gt;Ora podemos criar &lt;code&gt;inline&lt;/code&gt;, ora n√£o‚Ä¶ isso √© muito chato!&lt;/p&gt;

&lt;h3 id=&quot;a-soluo&quot;&gt;A Solu√ß√£o&lt;/h3&gt;

&lt;p&gt;Todas as novas inst√¢ncias ter√£o uma vari√°vel-interface para receber a refer√™ncia.&lt;/p&gt;

&lt;p&gt;Eu implemento essa ‚Äúm√°gica‚Äù de forma muito simples utilizando o m√©todo &lt;code&gt;New&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-pascal&quot; data-lang=&quot;pascal&quot;&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;TAction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TInterfacedObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IAction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;public&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ITask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ITask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ITask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;bp&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;  

&lt;span class=&quot;cm&quot;&gt;{ Implementa√ß√£o de Create e Execute... irrelevantes }&lt;/span&gt;  

&lt;span class=&quot;cm&quot;&gt;{ Implementa√ß√£o do m√©todo New tamb√©m para TTask... }&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;{...}&lt;/span&gt;  
  
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TFoo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;bp&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Agora n√≥s estamos chamando &lt;code&gt;TAction.New&lt;/code&gt; ao inv√©s de &lt;code&gt;TAction.Create&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;O m√©todo &lt;code&gt;New&lt;/code&gt; ir√° retornar uma inst√¢ncia de &lt;code&gt;IAction&lt;/code&gt; (interface) diferentemente do construtor
&lt;code&gt;Create&lt;/code&gt; que iria retornar uma inst√¢ncia de &lt;code&gt;TAction&lt;/code&gt; (classe).&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Sem problemas de &lt;code&gt;memleaks&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;C√≥digo mais limpo, sem vari√°veis locais&lt;/li&gt;
  &lt;li&gt;C√≥digo mais limpo, sem try-finally para desalocar vari√°veis locais&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Utilize o m√©todo &lt;code&gt;New&lt;/code&gt; em todas as suas classes e nunca mais chame o construtor diretamente.
Assim voc√™ n√£o ter√° o problema da falta da vari√°vel-interface, seja por esquecimento ou por
mudan√ßas no c√≥digo.&lt;/p&gt;

&lt;p&gt;T√° gostando? Alguma d√∫vida? N√£o concorda? Posta a√≠ nos coment√°rios.&lt;/p&gt;
</description>
        <pubDate>Sun, 10 Jan 2016 00:00:00 +0000</pubDate>
        <link>http://objectpascalprogramming.com/posts/interfaces-e-o-metodo-estatico-new/</link>
        <guid isPermaLink="true">http://objectpascalprogramming.com/posts/interfaces-e-o-metodo-estatico-new/</guid>
      </item>
    
      <item>
        <title>Pensando em Objetos</title>
        <description>&lt;p&gt;Como Pensar em Objetos?&lt;/p&gt;

&lt;p&gt;Aqui vai uma resposta simples e direta:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Pensar em Objetos significa &lt;strong&gt;n√£o&lt;/strong&gt; implementar uma tarefa na forma de instru√ß√µes passo-a-passo para o computador.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;!--more--&gt;

&lt;p&gt;&lt;img src=&quot;/images/photo-1446511437394-36cdff3ae1b3.jpg&quot; alt=&quot;Pensando&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Pensar em Objetos √© uma mudan√ßa de paradigma enorme para quem come√ßou a programar em 
linguagens procedurais como C, ASM ou Pascal e n√£o conseguiu ‚Äî ou nunca quis ‚Äî mudar o &lt;em&gt;mindset&lt;/em&gt;
para entender como programar Orientado a Objetos.&lt;/p&gt;

&lt;p&gt;A tempos aprendemos sobre Heran√ßa, Encapsulamento e Polimorfismo, mas eu acho que todos n√≥s ‚Äî inclusive eu, no passado ‚Äî
n√£o entendemos a transi√ß√£o do Procedural para o paradigma Orientado a Objetos.&lt;/p&gt;

&lt;h2 id=&quot;programando-orientado-a-objetos&quot;&gt;Programando Orientado a Objetos&lt;/h2&gt;

&lt;p&gt;Nada melhor do que um exemplo pr√°tico para come√ßarmos a entender as diferen√ßas entre programa√ß√£o Procedural e Orientada a Objetos.&lt;/p&gt;

&lt;p&gt;Um cliente nos contratou. Um WebService est√° dispon√≠vel e precisamos construir um &lt;em&gt;Client&lt;/em&gt; para consumi-lo.&lt;/p&gt;

&lt;p&gt;Eu n√£o quero utilizar um gerador automatizado de c√≥digo para ler o WSDL e gerar uma classe
‚Äî existe essa op√ß√£o no Delphi e no Lazarus instalando um &lt;code&gt;package&lt;/code&gt; espec√≠fico.&lt;/p&gt;

&lt;p&gt;Ent√£o, hipoteticamente falando, temos um WebService simples com 5 m√©todos. Cada m√©todo tem os mesmos argumentos: usu√°rio e senha.&lt;/p&gt;

&lt;p&gt;As configura√ß√µes do WebService como Usu√°rio, Senha, URL, m√©todos do WebService que dever√£o ser executados, hor√°rio de execu√ß√£o, etc.
est√£o num arquivo de configura√ß√µes. Porque isso? Bem, esse WebService ser√° executado em &lt;code&gt;batch&lt;/code&gt; automaticamente em hor√°rios pr√©-programados.
E em cada hor√°rio alguns m√©todos ser√£o executados, em outros n√£o.&lt;/p&gt;

&lt;p&gt;Como √© automatizado, precisamos de um &lt;code&gt;Log&lt;/code&gt;. Em texto mesmo. Um &lt;code&gt;Log&lt;/code&gt; que grave a execu√ß√£o, m√©todo, hor√°rio, usu√°rio/senha, exe√ß√µes, etc.&lt;/p&gt;

&lt;p&gt;O cliente tamb√©m quer testar o WebService utilizando um Form (GUI) para ver se est√° tudo funcionando, mostrando na tela o XML recebido
de acordo com o m√©todo a ser executado, escolhido numa &lt;code&gt;ComboBox&lt;/code&gt;.
Quando o Form √© utilizado o sistema n√£o precisa criar &lt;code&gt;Log&lt;/code&gt;, mas precisa mostrar exce√ß√µes na tela. 
Mas quando em execu√ß√£o em &lt;code&gt;batch&lt;/code&gt;, ele precisa gravar o &lt;code&gt;Log&lt;/code&gt; de execu√ß√£o e de exce√ß√µes.&lt;/p&gt;

&lt;p&gt;Vejam que esse &lt;em&gt;Client&lt;/em&gt; √© para o pessoal de Infra ent√£o √© sem frescura mesmo: &lt;code&gt;Log&lt;/code&gt; em texto, roda em &lt;code&gt;batch&lt;/code&gt; e n√£o tem tela bonita.&lt;/p&gt;

&lt;p&gt;Para cada requisi√ß√£o, o &lt;em&gt;Client&lt;/em&gt; precisa:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Trazer o XML;&lt;/li&gt;
  &lt;li&gt;Fazer um &lt;em&gt;parser&lt;/em&gt; nos dados;&lt;/li&gt;
  &lt;li&gt;Fazer uma persist√™ncia com os dados obtidos;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Aqui est√° o c√≥digo &lt;strong&gt;Procedural&lt;/strong&gt; para consumir o WebService:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Aten√ß√£o&lt;/strong&gt;: Eu digitei a &lt;code&gt;procedure&lt;/code&gt; diretamente no post, sem teste de compila√ß√£o, ent√£o podem haver erros de sintaxe.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-pascal&quot; data-lang=&quot;pascal&quot;&gt;&lt;span class=&quot;k&quot;&gt;procedure&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TDpvAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Act&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TDpvService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Mapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TDpvXMLMappingInTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TXMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// FFileConfig √© um atributo da classe&lt;/span&gt;
  
  &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TDpvService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;Mapping&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TDpvXMLMappingInTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TXMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Create&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt; 
  &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Configura a URL do WebService&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;URL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
   
    &lt;span class=&quot;c1&quot;&gt;// Configura com verifica√ß√£o de exce√ß√£o&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WithCheck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Configura para gerar Log&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WithLog&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Client executa o m√©todo&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ExecuteMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;User&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Password&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Obt√©m as configura√ß√µes necess√°rias&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetXMLNodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;XMLNodes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Configura o XML gerado&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetXML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Executa e gera outro XML (sim, reutilizei a mesma vari√°vel)  :)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Executa a persist√™ncia&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Mapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SetXML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Mapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// N√£o pode esquecer de desalocar tudo&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Mapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;XMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Free&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;√â um c√≥digo Procedural e funciona (teoricamente).&lt;/p&gt;

&lt;p&gt;Parece f√°cil de ler, mas o c√≥digo tem complexidade onde n√£o deveria.
As classes tem fun√ß√µes demais ‚Äî mesmo separando em classes, continua procedural.&lt;/p&gt;

&lt;p&gt;Reparou nas &lt;strong&gt;linhas em branco&lt;/strong&gt; para ‚Äúfacilitar a leitura‚Äù? Fiz isso propositalmente por 2 motivos:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Queria destacar cada linha para voc√™ ter mais contexto do problema;&lt;/li&gt;
  &lt;li&gt;Ainda n√£o sei como alterar as configura√ß√µes do &lt;code&gt;highlight&lt;/code&gt; para deixar o c√≥digo menos polu√≠do quando eu usar coment√°rios :(&lt;/li&gt;
  &lt;li&gt;Todo mundo faz isso para facilitar a leitura‚Ä¶ certo? :)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Mas quando voc√™s programarem Orientado a Objetos, n√£o haver√° mais motivos para pular linhas dentro de um m√©todo, Ok?&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;Dica:&lt;/strong&gt; Pular linhas dentro de um m√©todo √© um &lt;strong&gt;‚Äúmal cheiro‚Äù&lt;/strong&gt; no c√≥digo.
Pode significar que voc√™ est√° fazendo coisas demais num √∫nico m√©todo.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;Nesse tipo de c√≥digo, a cada manuten√ß√£o, voc√™ se preocupa em quebrar alguma coisa.&lt;/p&gt;

&lt;p&gt;Para n√£o quebrar nada voc√™ precisa:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Chamar os m√©todos na sequ√™ncia correta&lt;/li&gt;
  &lt;li&gt;Chamar os &lt;code&gt;SetXXX&lt;/code&gt; na sequ√™ncia correta&lt;/li&gt;
  &lt;li&gt;Ter cuidado com as vari√°veis, suas inicializa√ß√µes e reutiliza√ß√£o&lt;/li&gt;
  &lt;li&gt;Instanciar os objetos na sequ√™ncia correta&lt;/li&gt;
  &lt;li&gt;Etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;N√£o tome cuidado e‚Ä¶ BUMM! Quebrou o c√≥digo. Debugg. Checagem das atribui√ß√µes na sequ√™ncia exata. Perda de tempo.&lt;/p&gt;

&lt;p&gt;N√£o? Voc√™ sabe que √© verdade :)&lt;/p&gt;

&lt;p&gt;O c√≥digo apresentado √© 100% Procedural, mesmo utilizando classes!
Voc√™ poderia usar mais classes e at√© mesmo Heran√ßa entre elas,
mas o c√≥digo continuaria Procedural. Voc√™ n√£o tem objetos, voc√™ tem &lt;strong&gt;fun√ß√µes agrupadas&lt;/strong&gt;
em blocos (classes) para fazer a√ß√µes para o &lt;strong&gt;orquestrador&lt;/strong&gt;, voc√™!&lt;/p&gt;

&lt;p&gt;E como estes mesmos requisitos poderiam ser codificados utilizando Orienta√ß√£o a Objetos,
sem um orquestrador, utilizando ‚Äúobjetos vivos‚Äù com &lt;strong&gt;encapsulamento&lt;/strong&gt; perfeito, minimizando a quebra de c√≥digo
em manuten√ß√µes futuras e com um c√≥digo muito mais &lt;strong&gt;elegante&lt;/strong&gt;?&lt;/p&gt;

&lt;p&gt;Aqui est√° o c√≥digo &lt;strong&gt;Orientado a Objetos&lt;/strong&gt; para consumir o mesmo WebService:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objectpascal&quot; data-lang=&quot;objectpascal&quot;&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TDpvAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Act&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IActionResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt;
  &lt;span class=&quot;bp&quot;&gt;Result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TDpvXMLMappingInTable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;MethodsVsTables&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;TDpvXMLIterable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;XMLNodes&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;TDpvServiceWithLogging&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TDpvServiceWithChecking&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;TDpvService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;URL&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;TDpvMethod&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;WebMethodName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;TWebAuthorization&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;User&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;FFileConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;WebService&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;Password&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;XML&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Act&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Esse √© um c√≥digo verdadeiramente Orientado a Objetos. N√£o dizemos ao computador linha-a-linha sobre o que fazer.
Os Objetos sabem o que fazer! Eles n√£o precisam de um &lt;strong&gt;orquestrador&lt;/strong&gt; lhes dizendo o que fazer a cada momento.
Crie-os j√° configurados e deixe-os conversarem entre si. Eles sabem os m√©todos a chamar e &lt;strong&gt;quando&lt;/strong&gt; cham√°-los.
Eles podem criar objetos internamente ou n√£o e isso √© irrelevante para o c√≥digo chamador. Eles s√£o como uma
caixa preta, ningu√©m sabe o que h√° dentro deles. Voc√™, o programador, s√≥ precisa saber o &lt;strong&gt;contrato&lt;/strong&gt; que o
objeto dever√° cumprir. Esse contrato chamamos de &lt;code&gt;interface&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;N√£o d√° pra ver no c√≥digo por motivos de simplifica√ß√£o, mas cada inst√¢ncia √© do tipo de uma &lt;code&gt;interface&lt;/code&gt;, por isso temos os m√©todos &lt;code&gt;New&lt;/code&gt; ‚Äî um padr√£o
que eu defini para meus projetos para contornar uma &lt;code&gt;feature&lt;/code&gt; do compilador mas s√≥ irei falar a respeito em outros posts.&lt;/p&gt;

&lt;p&gt;Ao inv√©s de uma &lt;code&gt;procedure&lt;/code&gt; agora temos uma &lt;code&gt;function&lt;/code&gt; que retorna um &lt;code&gt;IActionResult&lt;/code&gt; e o fato de ter apenas um &lt;code&gt;Result&lt;/code&gt; √© um √≥timo sinal de que a fun√ß√£o
n√£o faz coisas demais. Essa fun√ß√£o √© como um grande objeto ou uma composi√ß√£o deles ‚Äî vou falar mais sobre isso em futuros posts.&lt;/p&gt;

&lt;p&gt;Se todas as inst√¢ncias s√£o do tipo &lt;code&gt;interface&lt;/code&gt;, ent√£o n√£o preciso desalocar nada manualmente
deixando o c√≥digo mais &lt;code&gt;clean&lt;/code&gt; sem try-finally e sem &lt;code&gt;memleaks&lt;/code&gt; (caso esque√ßa algum .Free).&lt;/p&gt;

&lt;p&gt;Todos os objetos s√£o &lt;strong&gt;imut√°veis&lt;/strong&gt;, ou seja, ap√≥s criados n√£o h√° nenhum &lt;code&gt;SetXXX&lt;/code&gt; que altere seu &lt;strong&gt;estado interno&lt;/strong&gt;.
Ent√£o n√£o configuro meu &lt;em&gt;Client&lt;/em&gt;, e nenhum outro objeto, utilizando m√©todos &lt;code&gt;SetXXX&lt;/code&gt; para ele trabalhar com &lt;code&gt;Log&lt;/code&gt; 
ou com checagem de exce√ß√µes.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;Dica:&lt;/strong&gt; Toda classe deveria ser imut√°vel, a n√£o ser que tenha uma √≥tima raz√£o para n√£o ser.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;Eu uso &lt;code&gt;Decorators&lt;/code&gt; ao inv√©s de &lt;code&gt;properties&lt;/code&gt; ou &lt;code&gt;SetXXX&lt;/code&gt; para ligar/desligar &lt;code&gt;flags&lt;/code&gt; (atributos).
Assim n√£o preciso &lt;strong&gt;completar&lt;/strong&gt; a(s) classe(s) numa sequ√™ncia correta de chamadas dos m√©todos.&lt;/p&gt;

&lt;p&gt;Se eu n√£o preciso do &lt;code&gt;Log&lt;/code&gt;, n√£o utilizo o &lt;code&gt;decorator&lt;/code&gt; do &lt;code&gt;Service&lt;/code&gt; de &lt;code&gt;Log&lt;/code&gt; que chamei de &lt;code&gt;TDpvServiceWithLogging&lt;/code&gt;;
o mesmo para a checagem de Exce√ß√µes, que chamei de &lt;code&gt;TDpvServiceWithChecking&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;O m√©todo de chamada no WebService √© uma classe separada, que chamei de &lt;code&gt;TDpvMethod&lt;/code&gt;.
Cada autoriza√ß√£o (usu√°rio/senha) tamb√©m √© uma classe, que chamei de &lt;code&gt;TWebAuthorization&lt;/code&gt;‚Ä¶ enfim.&lt;/p&gt;

&lt;p&gt;Viu as diferen√ßas?&lt;/p&gt;

&lt;p&gt;Espero que voc√™ tenha visto as vantagens de programar Orientado a Objetos, mesmo com esse exemplo simples.&lt;/p&gt;

&lt;p&gt;T√° gostando? Alguma d√∫vida? N√£o concorda? Posta a√≠ nos coment√°rios.&lt;/p&gt;

&lt;p&gt;Vejo voc√™ no pr√≥ximo post.&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;Dica:&lt;/strong&gt; Sugiro a leitura do livro Object Thinking de David West. Leia-o com a mente aberta e come√ßar√° a entender mais sobre o &lt;strong&gt;Pensamento Objeto&lt;/strong&gt;.
&lt;a href=&quot;http://www.amazon.com/Object-Thinking-Developer-Reference-David/dp/0735619654&quot;&gt;&lt;img src=&quot;/images/object-thinking-book.jpg&quot; alt=&quot;Object Thinking&quot; title=&quot;Object Thinking by David West&quot; /&gt;&lt;/a&gt;&lt;/p&gt;

</description>
        <pubDate>Sun, 03 Jan 2016 00:00:00 +0000</pubDate>
        <link>http://objectpascalprogramming.com/posts/pensando-em-objetos/</link>
        <guid isPermaLink="true">http://objectpascalprogramming.com/posts/pensando-em-objetos/</guid>
      </item>
    
      <item>
        <title>Voc√™ sabe, com certeza, o que √© Orienta√ß√£o a Objetos?</title>
        <description>&lt;p&gt;&lt;img src=&quot;/images/photo-1451340124423-6311db67a5d9.jpg&quot; alt=&quot;Rochas&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;um-pouco-de-histria&quot;&gt;Um pouco de Hist√≥ria&lt;/h2&gt;

&lt;p&gt;Muitos programadores, ao menos uma vez na vida, j√° devem ter pesquisado 
o que significa &lt;strong&gt;Orienta√ß√£o a Objetos&lt;/strong&gt;, quando o termo foi cunhado e por quem.&lt;/p&gt;

&lt;!--more--&gt;

&lt;p&gt;H√° v√°rios sites hoje em dia contendo essas informa√ß√µes, ent√£o n√£o vou 
replic√°-las aqui‚Ä¶ bem, s√≥ pra lembrar rapidamente: o criador do termo foi Alan Kay, 
o mesmo criador da linguagem Smalltalk ‚Äî uma linguagem puramente 
Orientada a Objetos ‚Äî no entanto, mesmo antes do termo ter sido criado, 
ideias conceituais sobre Orienta√ß√£o a Objetos j√° estavam sendo aplicadas 
na linguagem Simula 67 (1967).&lt;/p&gt;

&lt;p&gt;Linguagens de programa√ß√£o foram desenhadas com base nesse paradigma; centenas ou milhares de livros foram escritos; milh√µes de sites na Internet falam desse assunto. Ent√£o porque, ap√≥s todos esses anos, a maioria dos programadores ainda n√£o sabem o que √© programar Orientado a Objetos?&lt;/p&gt;

&lt;h2 id=&quot;um-objeto-no--um-balde-de-funes-e-dados&quot;&gt;Um Objeto n√£o √© um ‚Äúbalde‚Äù de Fun√ß√µes e Dados&lt;/h2&gt;

&lt;p&gt;Ok, &lt;ins&gt;tecnicamente&lt;/ins&gt; ele √© um ‚Äúbalde‚Äù de fun√ß√µes e dados.
Quando um objeto √© criado ele possui uma estrutura de dados em mem√≥ria; cada fun√ß√£o recebe um ponteiro impl√≠cito para essa estrutura; as fun√ß√µes podem utilizar esses dados como se fossem vari√°veis locais‚Ä¶ basicamente √© isso.&lt;/p&gt;

&lt;p&gt;Mas se voc√™ n√£o for um projetista de compiladores, pouco importa saber como um Objeto √© gerenciado internamente pelo compilador ‚Äî muitos programadores Java nem sabem o que √© um ponteiro :)&lt;/p&gt;

&lt;p&gt;Ent√£o fun√ß√µes e dados ganharam novos nomes: fun√ß√µes s√£o chamadas de M√©todos e dados s√£o chamados de Atributos ou Propriedades.&lt;/p&gt;

&lt;p&gt;Utilizar as palavras M√©todos e Atributos j√° √© um grande passo para entender o que s√£o Objetos, mas eu prefiro dizer que um Objeto tem &lt;strong&gt;Comportamento&lt;/strong&gt; e &lt;strong&gt;Estado&lt;/strong&gt;, respectivamente.&lt;/p&gt;

&lt;p&gt;E qual a diferen√ßa (te√≥rica) entre &lt;ins&gt;M√©todos vs Comportamentos&lt;/ins&gt; e &lt;ins&gt;Atributos vs Estado&lt;/ins&gt;?
Se voc√™ ‚Äúexecuta sequencialmente os m√©todos‚Äù de um Objeto e/ou ‚Äúatualiza seus atributos‚Äù, voc√™ utiliza &lt;strong&gt;Programa√ß√£o Procedural&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;√â assunto para outro post explicar as diferen√ßas sutis de nomenclatura, assim como as afirma√ß√µes que fiz acima, mas se for poss√≠vel para voc√™ apenas aceitar tais defini√ß√µes por enquanto, continue lendo.&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;
    ‚ÄúA orienta√ß√£o a objetos √© um modelo de an√°lise,
    projeto e programa√ß√£o de sistemas de software baseado
    na composi√ß√£o e intera√ß√£o entre diversas unidades de
    software chamadas de objetos.‚Äù 
  &lt;/p&gt;
  &lt;footer&gt;&lt;cite title=&quot;Wikipedia&quot;&gt;‚Äî Wikipedia&lt;/cite&gt;&lt;/footer&gt;
&lt;/blockquote&gt;

&lt;p&gt;Objetos podem ser &lt;strong&gt;compostos&lt;/strong&gt; por outros Objetos e eles &lt;strong&gt;interagem&lt;/strong&gt; entre si.&lt;/p&gt;

&lt;p&gt;Fun√ß√µes s√£o executadas. Objetos interagem entre si.&lt;/p&gt;

&lt;p&gt;Nunca pensem em Objetos em termos de fun√ß√µes e dados. Nunca.&lt;/p&gt;

&lt;p&gt;Para n√≥s, de agora em diante, um Objeto representa uma entidade, 
criatura ou qualquer coisa fora do contexto do programa.&lt;/p&gt;

&lt;p&gt;Alguns dizem, tamb√©m, que um Objeto representa uma entidade na ‚Äúvida real‚Äù. 
A defini√ß√£o est√° correta, por√©m pode gerar confus√£o, por exemplo:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Um cachorro √© uma entidade na vida real? Sim.&lt;/li&gt;
  &lt;li&gt;Uma pessoa √© uma entidade na vida real? Sim.&lt;/li&gt;
  &lt;li&gt;Um arquivo de computador √© uma entidade na vida real? Sim.&lt;/li&gt;
  &lt;li&gt;Um pixel √© uma entidade na vida real? Sim.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Se voc√™ n√£o notou diferen√ßa entre os exemplos, parab√©ns. Mas se ficou em d√∫vida a 
respeito dos itens #3 e #4, tudo bem, muitos tem a mesma d√∫vida. Por isso eu digo 
que um Objeto √© qualquer coisa fora do contexto do programa. Definir como ‚Äúvida real‚Äù 
tamb√©m est√° certo e tem a vantagem de ser mais r√°pido pra escrever üòâ&lt;/p&gt;

&lt;h2 id=&quot;os-programadores-no-utilizam-orientao-a-objetos&quot;&gt;Os programadores n√£o utilizam Orienta√ß√£o a Objetos&lt;/h2&gt;

&lt;p&gt;Estou afirmando com base na minha experi√™ncia pessoal com o mercado brasileiro, 
livros e in√∫meros post lidos por mim no decorrer dos anos.&lt;/p&gt;

&lt;p&gt;Voc√™ pode entender isso como uma coisa boa ou ruim. Depende do ponto de vista. 
Existe a Programa√ß√£o Funcional e muitas (grandes) empresas a utilizam. 
Programa√ß√£o Funcional n√£o tem nada haver com Orienta√ß√£o a Objetos e, tudo bem.&lt;/p&gt;

&lt;p&gt;Mas, aten√ß√£o. N√£o pense que voc√™ programa Orientado a Objetos s√≥ 
porque utiliza &lt;strong&gt;Classes&lt;/strong&gt;, &lt;strong&gt;Heran√ßa&lt;/strong&gt;, &lt;strong&gt;Encapsulamento&lt;/strong&gt; e, talvez, 
&lt;strong&gt;Polimorfismo&lt;/strong&gt;. Esse √© a base, mas n√£o √© tudo.&lt;/p&gt;

&lt;p&gt;N√£o somos diferentes. Eu pensava que programava Orientado a Objetos por 
usar e aplicar ‚Äî ou achar que estava aplicando ‚Äî esses conceitos b√°sicos da 
Orienta√ß√£o a Objetos que nos ensinaram no meio acad√™mico. Mas n√£o foi o bastante.&lt;/p&gt;

&lt;p&gt;Esqueceram de nos ensinar como &lt;strong&gt;Pensar Orientado a Objetos&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Mas isso √© assunto para um pr√≥ximo post.&lt;/p&gt;
</description>
        <pubDate>Sun, 27 Dec 2015 15:00:00 +0000</pubDate>
        <link>http://objectpascalprogramming.com/posts/o-que-e-orientacao-a-objetos/</link>
        <guid isPermaLink="true">http://objectpascalprogramming.com/posts/o-que-e-orientacao-a-objetos/</guid>
      </item>
    
  </channel>
</rss>
